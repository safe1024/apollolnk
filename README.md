# ApolloLnk - LNK 快捷方式生成工具

## 📋 项目简介

ApolloLnk 是一款功能强大的 Windows LNK 快捷方式生成工具，支持参数隐藏、图标伪造、文件打包等多种高级功能，适用于安全研究、渗透测试等场景。

## ✨ 核心亮点

### 1. **多种执行方式**
- **PowerShell 模式**：隐藏窗口执行，支持复杂命令
- **Explorer 模式**：使用 VBS 脚本隐藏窗口执行
- **FTP 模式**：通过 FTP 脚本文件执行

### 2. **内嵌模板模式**
- 自动生成多级伪造目录结构（5-14 层随机目录）
- 自动复制文件到伪造路径
- 自动生成 LNK 文件和脚本文件
- 支持一键打包所有文件

### 3. **附加运行文件功能**
- 支持同时打开文档（PDF/Word/Excel 等）和执行程序
- 先打开文档再执行程序，达到以假乱真的效果
- 所有文件自动打包到同一目录

### 4. **图标伪造**
- 支持多种预设图标（PDF、Word、Excel、PPT、图片等）
- 支持从系统 DLL 中选择自定义图标（shell32.dll、imageres.dll 等）
- 图标预览功能，所见即所得

### 5. **文件隐藏功能**
- 支持使用 `attrib +S +H` 隐藏生成的目录
- 隐藏命令在后台执行，不显示 CMD 窗口

### 6. **中文支持**
- 完美支持中文文件名和路径
- VBS 脚本使用 UTF-16 LE 编码，确保中文文件名正确执行

### 7. **文件大小填充**
- 支持自定义 LNK 文件大小
- 通过填充技术使文件大小符合预期

## 🚀 使用方式

### 内嵌模板模式

**适用场景**：快速生成包含 payload 的 LNK 文件

1. **选择文件**
   - 点击"点击多选"按钮
   - 选择要执行的文件（支持多选）
   - 在右侧列表中选择要执行的主文件（单选框）

2. **选择执行方式**
   - **PowerShell**：隐藏窗口执行
   - **Explorer**：使用 VBS 脚本隐藏窗口执行
   - **FTP**：通过 FTP 脚本文件执行

3. **设置 LNK 名称**
   - 输入 LNK 文件名（不包含 .lnk 后缀会自动添加）

4. **附加运行文件（可选）**
   - 点击"浏览"按钮选择附加文件（PDF/文档等）
   - 执行时会先打开附加文件，再执行主程序

5. **高级选项**
   - **伪造图标**：选择图标类型或自定义 DLL 图标
   - **文件大小**：设置 LNK 文件大小（字节，0 表示不填充）
   - **描述/备注**：设置 LNK 文件的备注信息（支持换行）
   - **隐藏参数模式**：启用参数隐藏技术
   - **隐藏文件**：使用 `attrib +S +H` 隐藏生成的目录

6. **生成**
   - 点击"生成快捷方式"按钮
   - 生成的文件位于：`时间戳_payload` 目录
   - LNK 文件在根目录，payload 文件在多级伪造目录中

### 自定义模式

**适用场景**：手动指定所有参数

1. **目标程序**：选择要执行的程序路径
2. **命令参数**：输入命令行参数
3. **输出路径**：指定 LNK 文件保存位置
4. **高级选项**：同内嵌模板模式
5. **生成**：点击"生成快捷方式"按钮

### 图标选择

1. 在"伪造图标"下拉框中选择"🎨 自定义DLL图标..."
2. 在弹出的模态窗口中选择 DLL 文件
3. 浏览图标并点击选择
4. 选中的图标会显示在预览区域

## 📁 文件结构

生成的文件结构示例：

```
20260112_000333_payload/
├── payload.lnk                    # LNK 快捷方式文件
└── _CL_176814/                    # 伪造目录（可能有多层）
    └── _CL_176814/
        └── _CL_176814/
            ├── script.vbs         # VBS 脚本（Explorer 模式）
            ├── script.dat         # FTP 脚本（FTP 模式）
            ├── payload.exe        # 主程序
            └── document.pdf        # 附加文件（如果有）
```

## 📝 更新日志

### Version 1.0.0 内测版本

- ✅ 支持参数隐藏技术
- ✅ 支持多种执行方式（PowerShell、Explorer、FTP）
- ✅ 支持内嵌模板模式
- ✅ 支持附加运行文件
- ✅ 支持图标伪造
- ✅ 支持文件隐藏
- ✅ 支持中文文件名

## ⚠️ 注意事项

### 安全警告

1. **仅用于合法用途**
   - 本工具仅用于安全研究、渗透测试、授权测试等合法场景
   - 禁止用于非法攻击、恶意软件传播等违法行为
   - 使用者需自行承担使用本工具的法律责任

2. **杀毒软件检测**
   - 生成的 LNK 文件可能被部分杀毒软件标记为可疑
   - 这是正常现象，因为使用了参数隐藏等技术
   - 建议在测试环境中使用

---

**免责声明**：本工具仅用于合法的安全研究和测试目的。使用者需自行承担使用本工具的所有法律责任。开发者不对任何滥用行为负责。
